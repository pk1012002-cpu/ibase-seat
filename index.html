

<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IBASE 26th Anniversary</title>
  <style>
    :root{
      --border:#cfcfcf;
      --text:#222;
      --muted:#666;
      --accent:#2563eb;
      --seatFill:#ffffff;
      --seatStroke:#444;
      --aisle:#efefef;
      --stage:#f6c200;
    }
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Noto Sans TC","Microsoft JhengHei",sans-serif;
      color:var(--text);
      background:#fafafa;
    }
    header{
      max-width:1200px;
      margin:0 auto;
      padding:16px 16px 8px;
    }
    h1{ margin:0 0 10px; font-size:18px; }
    .toolbar{
      display:grid;
      grid-template-columns:1fr auto auto;
      gap:10px;
      align-items:center;
    }
    input{
      padding:10px 12px;
      border-radius:10px;
      border:1px solid var(--border);
      font-size:14px;
      outline:none;
      background:#fff;
    }
    input:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 3px rgba(37,99,235,.15);
    }
    button{
      padding:10px 12px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#fff;
      cursor:pointer;
      font-size:14px;
    }
    button:hover{ background:#f5f5f5; }
    .hint{
      margin-top:8px;
      font-size:12px;
      color:var(--muted);
      line-height:1.5;
    }

    main{ max-width:1200px; margin:0 auto; padding:8px 16px 24px; }
    .frame{
      background:#fff;
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px;
      overflow:auto;
    }
    svg{ width:100%; height:auto; min-width:980px; }
	
    @media (max-width: 768px) {
      svg {
        min-width: 0;  
       }
    }

    /* SVG æ¨£å¼ */
    .seat circle{
      fill: var(--seatFill);
      stroke: var(--seatStroke);
      stroke-width: 2;
    }
    .seat text{
      font-size: 14px;
      font-weight: 700;
      text-anchor: middle;
      dominant-baseline: middle;
      fill:#111;
      pointer-events:none;
    }
    .seat.big text{ font-size: 15px; }
    .seat.hit circle{
      stroke: #e11d48;                 /* ç´…è‰²é‚Šæ¡† */
      stroke-width: 4;
      filter: drop-shadow(0 0 6px rgba(225,29,72,.45));
    }	
    .label{
      font-size:14px;
      fill:#333;
      font-weight:700;
    }
    .label.muted{ fill:#666; font-weight:600; font-size:13px; }
    .aisle{
      fill: var(--aisle);
      stroke: #d0d0d0;
      stroke-width: 1.5;
      rx: 8;
    }
    .stage{
      fill: var(--stage);
      stroke: #caa000;
      stroke-width: 2;
      rx: 10;
    }
    .outer{
      fill:none;
      stroke:#777;
      stroke-width:2;
      rx:14;
    }
  </style>
</head>
<body>
<header>
  <h1>åº§ä½åœ–</h1>
  <div class="toolbar">
    <input id="q" type="text" placeholder="æœå°‹æ¡Œè™Ÿæˆ–å§“åï¼š127ã€æ—ä½³ç©" />
    <button id="btnSearch" type="button">æœå°‹</button>
    <button id="btnReset" type="button">é‡è¨­</button>
  </div>
</header>

<main>
  <div class="frame">
    <svg id="map" viewBox="0 0 1000 560" role="img" aria-label="127æ¡Œåº§ä½åœ–">
      <!-- å¤–æ¡†ï¼ˆç¤ºæ„ï¼‰ -->
      <rect class="outer" x="20" y="20" width="960" height="520"></rect>

      <!-- èˆå°ï¼ˆé»ƒåº•ï¼‰ -->
      <rect class="stage" x="400" y="80" width="220" height="80"></rect>
      <text class="label" x="500" y="125">èˆå°</text>

      <!-- å…©æ¢å‡é™æ˜Ÿå…‰å¤§é“ï¼ˆç›´å‘èµ°é“ï¼‰ -->
      <rect class="aisle" x="280" y="80" width="45" height="405"></rect>
      <text class="label muted" x="347.5" y="270" transform="rotate(-90 347.5 310)">å‡é™æ˜Ÿå…‰å¤§é“</text>

      <rect class="aisle" x="690" y="130" width="45" height="355"></rect>
      <text class="label muted" x="702.5" y="325" transform="rotate(-90 702.5 310)">å‡é™æ˜Ÿå…‰å¤§é“</text>

      <rect class="aisle" x="210" y="21" width="180" height="50"></rect>
      <text class="label" x="280" y="40">L E D</text>

      <rect class="aisle" x="625" y="21" width="180" height="50"></rect>
      <text class="label" x="695" y="40">L E D</text>

      <rect class="aisle" x="470" y="252" width="70" height="35"></rect>
      <text class="label" x="485" y="275">æ”å½±å°</text>

      <!-- ç¾¤çµ„å®¹å™¨ï¼šåº§ä½æœƒç”± JS ç”¢ç”Ÿ -->
      <g id="seats"></g>
    </svg>
  </div>
  <div id="infoBox" style="
    background:#fff;
    border:1px solid #cfcfcf;
    border-radius:14px;
    padding:12px 14px;
    margin-bottom:10px;
    font-size:14px;
  ">
    <div style="font-weight:800; margin-bottom:6px;">å°šæœªé¸æ“‡æ¡Œä½</div>
    <div style="color:#666; font-size:13px;">è«‹é»é¸æ¡Œä½é¡¯ç¤ºæ¡Œè™Ÿèˆ‡äººåã€‚</div>
  </div>
</main>

<script>
	/* ===== æ¯æ¡Œ 10 å€‹äººå ===== */
	const seatNames = {
	  "1": [
		"æ—ç§‹æ—­", "æ—ä½³ç©",
	  ],
	  "20": [
		"Charlie","é™³ç¾éº—","æ—å¿—è±ª","é»ƒæ€¡å›","å¼µå®¶è±ª",
		"è²´è³“","è²´è³“","è²´è³“","è²´è³“","è²´è³“","è²´è³“", "è²´è³“",
	  ],
	  "21": [
		"Alice","Bob","é™³ç¾éº—","David","Eve",
		"Frank","Grace","Heidi","Ivan","Judy"
	  ],
	  "127": [
		"è‘£äº‹é•·","ç¸½ç¶“ç†","å‰¯ç¸½A","å‰¯ç¸½B","è²´è³“ä¸€",
		"è²´è³“äºŒ","è²´è³“ä¸‰","è²´è³“å››","è²´è³“äº”","è²´è³“å…­"
	  ]
	};

	/* æ²’è¨­å®šåå–®çš„æ¡Œï¼Œå›å‚³ç©ºé™£åˆ— */
	function getNames(no){
	  return seatNames[String(no)] || [];
	}
  // ============ åº§ä½è³‡æ–™ï¼ˆä¾ç…§åœ–çš„ç›¸å°ä½ç½®æ‰‹å‹•å®šä½ï¼‰ ============
  // åº§æ¨™ç³»ï¼šviewBox 1000x520
  // r: åŠå¾‘ï¼ˆä¸€èˆ¬ 18ï¼Œå¤§åœˆ 20ï¼‰
  const seats = [];

	/* è‡ªå‹•ä¾æ¡Œè™Ÿå¸¶å…¥ 10 å€‹äººå */
	function add(no, x, y, r=18){
	  seats.push({
		no: String(no),
		x, y, r,
		names: getNames(no)   // ğŸ‘ˆ é—œéµ
	  });
	}

  // ----- å·¦å€ (52-89) + 53 (å¤§) + 52 (å–®é¡†) -----
  add(52, 150, 105, 18);
  add(53, 250, 105, 18); // å¤§åœˆ

  // å·¦å€ 54-89ï¼š4æ¬„ x=[95,150,205,260], y å¾ 190 åˆ° 465
  const lx = [100,150,200,250];
  const ly = [190,235,280,325,370,415,460]; // 7æ’ * 4 = 28 (54-81) + å†åŠ å…©æ’è£œåˆ° 89
  // ä¾åœ–ï¼š54/55 åœ¨ç¬¬ä¸€æ’å·¦äºŒï¼Œ56/57 åœ¨ç¬¬ä¸€æ’å³äºŒï¼Œä»¥æ­¤é¡æ¨ï¼ˆæ¯æ’4é¡†ï¼‰
  let n = 54;
  const leftRows = [
    [54,55,56,57],
    [58,59,60,61],
    [62,63,64,65],
    [66,67,68,69],
    [70,71,72,73],
    [74,75,76,77],
    [78,79,80,81],
    [82,83,84,85],
    [86,87,88,89]
  ];
  const leftY = [190,235,280,325,370,415,460,505,550]; // ä½†è¶…å‡ºå¤–æ¡†ï¼Œæ”¹ç”¨è¼ƒç·Šçš„ 9 æ’
  // é‡æ–°ç”¨ 9 æ’ within 480ï¼š y å– 180..470
  const leftY2 = [150,190,230,270,310,350,390,430,470];
  for (let i=0;i<leftRows.length;i++){
    for (let j=0;j<4;j++){
      add(leftRows[i][j], lx[j], leftY2[i], 18);
    }
  }

  // ----- å·¦ä¸­ç›´åˆ— (42-51)ï¼Œ42 ç‚ºå¤§åœˆ -----
  add(42, 355, 105, 18); // å¤§åœˆ
  const col42to51 = [43,44,45,46,47,48,49,50,51];
  const cy = [150,190,230,270,310,350,390,430,470];
  for (let i=0;i<col42to51.length;i++){
    add(col42to51[i], 355, cy[i], 18);
  }

  // ----- ä¸­å€ (ä¸»æ¡Œ1-5 ä»¥ 1-5 è¡¨ç¤ºã€å…¶é¤˜ 6-41 + å³å´ç›´åˆ— 11/18/19/26/33/40 + 127) -----
  // ä¸»æ¡Œ 1~5ï¼ˆä½ç½®åœ¨èˆå°ä¸‹æ–¹ä¸€æ’ï¼Œèˆ‡åœ–ä¸€è‡´ï¼‰
  add(1, 401, 215, 20);
  add(2, 460, 215, 20);
  add(3, 515, 215, 20);
  add(4, 570, 215, 20);
  add(5, 620, 205, 20);

  // 127ï¼ˆç¦ï¼‰èˆ‡ 6 åœ¨å³å´èµ°é“ä¸Šæ–¹
  add(127, 710, 105, 18);
  add(6,   658, 170, 18);

  // å³å´ç›´åˆ—ï¼ˆé èµ°é“å…§å´ï¼‰ï¼š11 / 18 / 19 / 26 / 33 / 40
  const rightCol = [
    {no:11, y:240},
    {no:18, y:287},
    {no:19, y:335},
    {no:26, y:380},
    {no:33, y:425},
    {no:40, y:470} // æœƒåœ¨å¤–æ¡†å¤–ï¼Œç¨å¾®ä¸Šç§»
  ];
  rightCol.forEach(o => add(o.no, 658, Math.min(o.y, 470), 18));

  // ä¸­é–“æ¡Œä½ï¼ˆåŠ å¤§é–“è·ï¼‰ï¼š7-10ã€12-17ã€20-25ã€27-32ã€34-39ã€41
  // 7-10
  add(7, 400, 270, 18);
  add(8, 442, 270, 18);
  add(9, 568, 270, 18);
  add(10,610, 270, 18);

  // 12-17ï¼ˆå…­é¡†ï¼‰
  const row12 = [12,13,14,15,16,17];
  const x12 = [400,442,484,526,568,610]; // æœ€å¾Œä¸€é¡†é è¿‘èµ°é“å‰ç•™è·
  const y12 = 320;
  for (let i=0;i<row12.length;i++){
    add(row12[i], x12[i], y12, 18);
  }

  // 20-25
  const row20 = [20,21,22,24,25];
  const x20 = [400,442,484,568,610];
  const y20 = 370;
  for (let i=0;i<row20.length;i++){
    add(row20[i], x20[i], y20, 18);
  }

  // 23 30 37
  add(23, 526, 362, 18);
  add(30, 526, 408, 18);
  add(37, 526, 452, 18);

  // 27-32
  const row27 = [27,28,29,31,32];
  const x27 = [400,442,484,568,610];
  const y27 = 420;
  for (let i=0;i<row27.length;i++){
    add(row27[i], x27[i], y27, 18);
  }

  // 34-39
  const row34 = [34,35,36,38,39];
  const x34 = [400,442,484,568,610];
  const y34 = 470; // åº•éƒ¨å†ç•™ä¸€é»
  for (let i=0;i<row34.length;i++){
    add(row34[i], x34[i], y34, 18);
  }

  // 41ï¼ˆåº•éƒ¨ä¸­é–“ï¼‰
  add(41, 526, 495, 18); // ç¨å¾®é ä¸‹ï¼Œä»åœ¨å¤–æ¡†å…§ï¼ˆçœ‹èµ·ä¾†åƒä½ åœ–ï¼‰

  // ----- å³å€ (90-126) -----
  add(90, 865, 105, 18);
  const rx = [765,815,865,915]; // å³å´é é‚Šç¸®ä¸€é»
  const ry = [150,190,230,270,310,350,390,430,470];
  const rightRows = [
    [91,92,93,94],
    [95,96,97,98],
    [99,100,101,102],
    [103,104,105,106],
    [107,108,109,110],
    [111,112,113,114],
    [115,116,117,118],
    [119,120,121,122],
    [123,124,125,126]
  ];
  for (let i=0;i<rightRows.length;i++){
    for (let j=0;j<4;j++){
      add(rightRows[i][j], rx[j], ry[i], 18);
    }
  }

  // âœ… ä¾æ¡Œè™Ÿæ‰¾åˆ° seats è£¡çš„è³‡æ–™ï¼ˆåŒ…å« namesï¼‰
  function findSeat(no){
    return seats.find(s => s.no === String(no));
  }
  
  // âœ… æ›´æ–°è³‡è¨Šé¢æ¿ï¼ˆno æœ‰å€¼ï¼é¡¯ç¤ºæ¡Œä½ï¼›no æ²’å€¼ï¼é‡è¨­ï¼‰
  function showSeatInfo(no){
    const box = document.getElementById("infoBox");
    if (!box) return;
  
    // ğŸ”¹ Reset / å°šæœªé¸æ“‡
    if (!no){
      box.innerHTML = `
        <div style="font-weight:800; margin-bottom:6px;">å°šæœªé¸æ“‡æ¡Œä½</div>
        <div style="color:#666; font-size:13px;">è«‹é»é¸æ¡Œä½é¡¯ç¤ºæ¡Œè™Ÿèˆ‡äººåã€‚</div>
      `;
      return;
    }
  
    // ğŸ”¹ æ‰¾æ¡Œä½
    const seat = findSeat(no);
    if (!seat){
      box.innerHTML = `
        <div style="font-weight:800; margin-bottom:6px;">æ‰¾ä¸åˆ°æ¡Œä½ï¼š${no}</div>
      `;
      return;
    }
  
    // ğŸ”¹ é¡¯ç¤ºæ¡Œä½äººå
    const names = seat.names && seat.names.length
      ? seat.names
      : ["ï¼ˆæ­¤æ¡Œå°šæœªè¨­å®šäººåï¼‰"];
  
    const list = names
      .map(n => `<li style="margin:2px 0;">${n}</li>`)
      .join("");
  
    box.innerHTML = `
      <div style="display:flex; align-items:center; gap:10px; margin-bottom:6px;">
        <div style="font-weight:900; font-size:16px;">æ¡Œè™Ÿï¼š${seat.no}</div>
        <div style="color:#666; font-size:13px;">å…± ${seat.names.length} äºº</div>
      </div>
      <ol style="margin:0; padding-left:18px;">
        ${list}
      </ol>
    `;
  }

  // ============ æ¸²æŸ“ SVG åº§ä½ ============
  const seatsG = document.getElementById("seats");

  function seatEl(s){
    const g = document.createElementNS("http://www.w3.org/2000/svg","g");
    g.setAttribute("class", "seat" + (s.r>=20 ? " big" : ""));
    g.dataset.no = s.no;
	
    /* ğŸ‘‡ æŠŠ 10 å€‹åå­—å­˜é€² datasetï¼ˆè½‰å°å¯«æ–¹ä¾¿æœå°‹ï¼‰ */
    g.dataset.names = (s.names || []).join(" ").toLowerCase();
  
    const c = document.createElementNS("http://www.w3.org/2000/svg","circle");
    c.setAttribute("cx", s.x);
    c.setAttribute("cy", s.y);
    c.setAttribute("r", s.r);

    const t = document.createElementNS("http://www.w3.org/2000/svg","text");
    t.setAttribute("x", s.x);
    t.setAttribute("y", s.y);
    t.textContent = s.no;

    g.appendChild(c);
    g.appendChild(t);

    g.addEventListener("click", () => {
      clearMarks();
      g.classList.add("hit");
	  
	  // âœ… é¡¯ç¤ºè©²æ¡Œäººåï¼ˆé‡é»ï¼‰
	  showSeatInfo(s.no);
	  
      // æ²åˆ°è¦–é‡ä¸­å¤®
      g.scrollIntoView({behavior:"smooth", block:"center", inline:"center"});
    });

    return g;
  }

  seats.forEach(s => seatsG.appendChild(seatEl(s)));

  // ============ æœå°‹ ============
  const q = document.getElementById("q");
  const btnSearch = document.getElementById("btnSearch");
  const btnReset = document.getElementById("btnReset");

  function parseQueryToNos(text){
    const t = text.trim();
    if (!t) return null;

    if (t.includes(",")){
      const nums = t.split(",")
        .map(x=>x.trim()).filter(Boolean)
        .map(x=>Number(x)).filter(n=>Number.isFinite(n))
        .map(n=>String(n));
      return nums.length ? Array.from(new Set(nums)) : null;
    }

    const m = t.match(/^(\d+)\s*-\s*(\d+)$/);
    if (m){
      const a = Number(m[1]), b = Number(m[2]);
      const lo = Math.min(a,b), hi = Math.max(a,b);
      const arr = [];
      for (let x=lo; x<=hi; x++) arr.push(String(x));
      return arr;
    }

    if (/^\d+$/.test(t)) return [String(Number(t))];
    return null;
  }

  function clearMarks(){
    document.querySelectorAll(".seat").forEach(el => el.classList.remove("hit"));
  }

  function applySearch(){
    const text = q.value.trim();
    clearMarks();
    if (!text) return;
  
    const nos = parseQueryToNos(text);   // æ¡Œè™Ÿ / ç¯„åœ
    const needle = text.toLowerCase();   // å§“åï¼ˆå…¨æ¯”å°ï¼‰
  
    let first = null;
  
    document.querySelectorAll(".seat").forEach(el => {
  	const no = el.dataset.no;
  
  	// âœ… dataset.names æ˜¯ "alice bob é™³ç¾éº— ..."ï¼ˆå°å¯«ï¼‰
  	const namesStr = el.dataset.names || "";
  	const namesArr = namesStr.split(" ").filter(Boolean);
  
  	let hit = false;
  
  	// 1) æ¡Œè™Ÿæœå°‹ï¼šå…¨å°ï¼ˆåŸæœ¬å°±å…¨å°ï¼‰
  	if (nos && nos.includes(no)) hit = true;
  
  	// 2) å§“åæœå°‹ï¼šå…¨å°ï¼ˆå®Œå…¨ç›¸ç­‰æ‰ç®—ï¼‰
  	if (!hit && !nos && namesArr.some(n => n === needle)) hit = true;
  
  	// 3) ç‰¹ä¾‹ï¼šè¼¸å…¥ã€Œç¦ã€æ‰¾ 127ï¼ˆä¹Ÿç®—å…¨å°ï¼‰
  	if (!hit && needle === "ç¦" && no === "127") hit = true;
  
  	if (hit){
  	  el.classList.add("hit");
  	  if (!first) first = el;
  	}
    });
  
    if (first){
  	first.scrollIntoView({behavior:"smooth", block:"center"});
  	showSeatInfo(first.dataset.no);
    }else{
  	alert("æ‰¾ä¸åˆ°ç¬¦åˆçš„æ¡Œä½æˆ–å§“å");
    }
  }

  btnSearch.addEventListener("click", applySearch);
  q.addEventListener("keydown", (e)=>{ if(e.key==="Enter") applySearch(); });
  btnReset.addEventListener("click", ()=>{ 
    q.value = ""; 
    clearMarks(); 
    showSeatInfo();   // â­ ä¸å‚³åƒæ•¸ï¼é‡è¨­ infoBox
  });
</script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body>
</html>
